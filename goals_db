import sqlite3

# Database filename
DB_NAME = "goals.db"

def connect():
    """
    Establish a connection to the SQLite database.
    Returns a connection object.
    """
    return sqlite3.connect(DB_NAME)

def create_table():
    """
    Create the 'goals' table if it doesn't already exist.
    Columns:
        - id: unique identifier (auto-incremented)
        - goal_name: name of the goal
        - goal_amount: amount allocated to the goal
    """
    conn = connect()
    cur = conn.cursor()
    cur.execute("""
        CREATE TABLE IF NOT EXISTS goals (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            goal_name TEXT,
            goal_amount REAL
        )
    """)
    conn.commit()
    conn.close()

def insert_goal(name, amount):
    """
    Insert a new goal into the database.
    Parameters:
        - name (str): name of the goal
        - amount (float): amount allocated
    """
    conn = connect()
    cur = conn.cursor()
    cur.execute("INSERT INTO goals (goal_name, goal_amount) VALUES (?, ?)", (name, amount))
    conn.commit()
    conn.close()

def fetch_goals():
    """
    Retrieve all goals from the database.
    Returns:
        - List of tuples: (id, goal_name, goal_amount)
    """
    conn = connect()
    cur = conn.cursor()
    cur.execute("SELECT id, goal_name, goal_amount FROM goals")
    goals = cur.fetchall()
    conn.close()
    return goals

def delete_goal(goal_id):
    """
    Delete a goal from the database using its unique ID.
    Parameters:
        - goal_id (int): ID of the goal to delete
    """
    conn = connect()
    cur = conn.cursor()
    cur.execute("DELETE FROM goals WHERE id = ?", (goal_id,))
    conn.commit()
    conn.close()
